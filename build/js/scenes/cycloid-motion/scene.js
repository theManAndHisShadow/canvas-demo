(()=>{"use strict";let e=new class{constructor({title:e,ui:r,code:t}){this.displayName="Scene",this.title=e,this.uiTree=r,this.ui=null,this.code=t,this.timestamp=null}execute({root:e}){let r=this.code;e.children[0].textContent=this.title,r(e,this.ui.display,this.ui.states)}}({title:"Cycloid motion",ui:{description:{type:"display-infobox",label:"Description",text:"A cycloid is the curve traced by a point on the circumference of a circle as it rolls along a straight line. The key condition in this motion is that the circle rolls without slipping. A specific example of a cycloid is the epicycloid, where a circle rolls inside a larger circle. An example of an hypocycloid is demonstrated in this interactive scene."},cycloids_info:{type:"display-item",label:"Rendered curves"},preset:{type:"preset-dropdown-list",label:"Preset",selectedByDefault:1,options:[{name:"Playground",allowedElements:["*"]},{name:"Hypocycloid overview",allowedElements:["speed"]},{name:"Flat roses curves overview",allowedElements:["speed"]},{name:"Spiral",allowedElements:["speed"]},{name:"Stars",allowedElements:["speed"]},{name:"Astroids",allowedElements:["speed"]}]},externalRadius:{type:"input",label:"Radius of external circle",defaultValue:120,minValue:60,maxValue:195},internalRadius:{type:"input",label:"Radius of inner circle",defaultValue:30,minValue:10,maxValue:100},radiusOfTracePoint:{type:"input",label:"Radius of trace point",minValue:3,defaultValue:30,maxValue:100},traceLength:{type:"input",label:"Trace length",minValue:200,defaultValue:600,maxValue:1e4},speed:{type:"input",label:"Speed",minValue:0,defaultValue:3,maxValue:20},invertRotationDirection:{type:"checkbox",label:"Invert circles rotation dirtection",state:!0},drawCenterPoint:{type:"checkbox",label:"Draw center point",state:!0},drawRadiusLine:{type:"checkbox",label:"Draw radius line",state:!0}},code:(e,r,t)=>{window.runningAnimations.clearQueue();const i=Date.now();let a=resetElement(e.querySelector("canvas"),`canvas-${i}`);const n=300,h=200;a.width=600,a.height=400;const C=a.getContext("2d",{willReadFrequently:!0}),x=["externalRadius","internalRadius","drawCenterPoint","drawRadiusLine","speed","traceLength","invertRotationDirection","radiusOfTracePoint"],f=()=>x.reduce(((e,r)=>(e[r]=t.getState(r),e)),{});let g=t.getState("speed"),R=(t.getState("traceLength"),{0:o(C,n,h,f()),1:l(C,n,h,f()),2:s(C,n,h,f()),3:c(C,n,h,f()),4:d(C,n,h,f()),5:u(C,n,h,f())}),p=1,b=R[p]||[],y="";t.subscribe(((e,i,a)=>{b.forEach(((r,t)=>{if(0==p){let e=f();for(let[t,i]of Object.entries(e))r.update(t,i)}"speed"==e&&(g=i)})),"preset"!=e&&"internalRadius"!=e&&"externalRadius"!=e&&"radiusOfTracePoint"!=e||(p=t.getState("preset"),b=R[p],y="",b.forEach(((e,r)=>{let t=truncateFloatNum(e.proportion.externalRadius/e.proportion.internalRadius,3);y+=`\n                        <br>\n                        <span class="small-font display-item__list-item">\n                            <span \n                                class="small-font gray-word-bubble" \n                                style="color: ${e.traceColor}; background: ${changeColorOpacity(e.traceColor,.25)};"\n                            >${e.label} #${r+1}</span><span> - R/r = ${t}/1, d ${e.proportion.internalRadius==e.proportion.radiusOfTracePoint?"=":e.proportion.radiusOfTracePoint>e.proportion.internalRadius?">":"<"} r</span>\n                        </span>\n                    `})),r.updateValue("cycloids_info",`${y}`))})),window.runningAnimations.add((()=>{C.clearRect(0,0,600,400),drawRect(C,{x:0,y:0,width:600,height:400,fillColor:getColor("black",.98)}),b.forEach((e=>{e.animate(g),e.render()}))})),t.setState("preset",t.getState("preset"))}});window.exportedObjects.push(e);class r{#e=[];constructor({color:e,length:r=100,thickness:t=1,parent:i}){this.length=r,this.color=e,this.thickness=t,this.parent=i}push(e){"number"==typeof e.x&&"number"==typeof e.y&&(this.#e.length>this.length&&this.#e.shift(),this.#e.push(e))}getLastPoint(){return this.#e.length>0&&getArrayLast(this.#e)}getLength(){return this.#e.length}clear(){this.#e=[]}render(){this.parent.renderer.beginPath(),this.parent.renderer.strokeStyle=this.color,this.parent.renderer.lineWidth=1;let e=!0;this.#e.forEach((r=>{e?(this.parent.renderer.moveTo(r.x,r.y),e=!1):this.parent.renderer.lineTo(r.x,r.y)})),this.parent.renderer.stroke()}}class t{constructor({id:e=null,type:r,parent:t,renderer:i,cx:a,cy:n,radius:o,borderColor:l,borderThickness:s,fillColor:c,drawCenterPoint:d=!1,drawRadiusLine:u=!1}){this.id=e,this.parent=t,this.cx=a,this.cy=n,this.radius=o,this.fillColor=c,this.borderColor=l,this.borderThickness=s,this.type=r,this.renderer=i,this.drawCenterPoint=d,this.drawRadiusLine=u}render(){drawCircle(this.renderer,{cx:this.cx,cy:this.cy,r:this.radius,borderThickness:this.borderThickness,borderColor:this.borderColor,fillColor:this.fillColor}),!0===this.drawCenterPoint&&drawCircle(this.renderer,{cx:this.cx,cy:this.cy,r:1,borderThickness:this.borderThickness,borderColor:this.borderColor,fillColor:this.borderColor})}}class i extends t{constructor({id:e=null,type:r,parent:t,renderer:i,cx:a,cy:n,radius:o,borderColor:l,borderThickness:s,fillColor:c,drawCenterPoint:d=!1,drawRadiusLine:u=!1}){super(arguments[0])}}class a extends t{constructor({id:e=null,type:t,parent:i,renderer:a,cx:n,cy:o,radius:l,borderColor:s,borderThickness:c,fillColor:d,drawCenterPoint:u=!1,drawRadiusLine:h=!1,origin:C,offset:x,angle:f=0,traceLength:g=1e3,traceColor:R=getColor("red"),traceThickness:p,radiusOfTracePoint:b,invertRotationDirection:y=!1}){super({id:e,type:t,parent:i,renderer:a,cx:n,cy:o,radius:l,borderColor:s,borderThickness:c,fillColor:d,drawCenterPoint:u,drawRadiusLine:h}),this.origin=C||{x:this.parent.cx,y:this.parent.cy},this.offset=x,this.angle=f,this.globalAngle=0,this.staticCX=n,this.staticCY=o-x,this.trace=new r({color:R,length:g,thickness:p,parent:this}),this.radiusOfTracePoint=b,this.invertRotationDirection=y}rotate(e){this.angle+=e,this.angle>=360&&(this.angle=0)}moveAroundOrigin(e=1){this.globalAngle=(this.globalAngle+e)%360;const r=rotatePoint(this.origin.x,this.origin.y,this.staticCX,this.staticCY,this.globalAngle);r&&"number"==typeof r.x&&"number"==typeof r.y&&(this.cy=r.y-this.offset,this.cx=r.x)}render(){let e=this.cx+0,r=this.cy+this.offset;drawCircle(this.renderer,{cx:e,cy:r,r:this.radius,borderThickness:this.borderThickness,borderColor:this.borderColor,fillColor:this.fillColor}),!0===this.drawCenterPoint&&drawCircle(this.renderer,{cx:e,cy:r,r:1,borderThickness:this.borderThickness,borderColor:this.borderColor,fillColor:this.borderColor});let t=rotatePoint(e,r,e,r+this.radiusOfTracePoint,this.angle);(0==this.trace.getLength()||(e=>{if(this.trace.length>0){let r=this.trace.getLastPoint();return getDistanseBetweenTwoPoint(r.x,r.y,e.x,e.y)>=3}return!1})(t))&&this.trace.push(t),!0===this.drawRadiusLine&&(drawLine(this.renderer,{x1:e,y1:r,x2:t.x,y2:t.y,thickness:this.borderThickness,color:this.borderColor}),drawCircle(this.renderer,{cx:t.x,cy:t.y,r:1,borderThickness:1,borderColor:getColor("white"),fillColor:getColor("white")}))}}class n{constructor({cx:e,cy:r,label:t="",animationSpeed:n,externalRadius:o,internalRadius:l,drawCenterPoint:s,externalBorderColor:c=getColor("white",.45),internalBorderColor:d=getColor("white",.45),traceColor:u=getColor("white"),traceThickness:h=1,traceLength:C,drawRadiusLine:x,renderer:f,invertRotationDirection:g,radiusOfTracePoint:R,internalRotationGain:p=1,internalInitialAngle:b=0}){this.renderer=f,this.cx=e,this.cy=r,this.label=t,this.animationSpeed=n,this.internalRotationGain=p,this.drawCenterPoint=s,this.traceColor=u,this.proportion={externalRadius:o,internalRadius:l,radiusOfTracePoint:R};let y=o-l;this.skeleton=[new i({id:0,type:"external",cx:this.cx,cy:this.cy,parent:this,radius:o,fillColor:"transparent",borderColor:c,borderThickness:1,renderer:this.renderer,drawCenterPoint:s,drawRadiusLine:x}),new a({id:1,type:"internal",cx:this.cx,cy:this.cy,angle:b,offset:-y,radius:l,fillColor:"transparent",borderColor:d,traceLength:C,traceThickness:h,traceColor:u,borderThickness:1,drawCenterPoint:s,drawRadiusLine:x,parent:this,renderer:this.renderer,invertRotationDirection:g,radiusOfTracePoint:R})]}update(e,r){this.skeleton.forEach((t=>{if("drawCenterPoint"===e&&(t.drawCenterPoint=r),"invertRotationDirection"===e||"radiusOfTracePoint"===e||"drawRadiusLine"==e){let t=this.skeleton.filter((e=>"internal"===e.type));t.forEach((t=>{t[e]=r})),"radiusOfTracePoint"===e&&(this.proportion.radiusOfTracePoint=r)}if("traceLength"==e){let e=this.skeleton.filter((e=>"internal"===e.type));e.forEach((e=>{e.trace.length=r}))}if("external"===t.type&&"externalRadius"===e){let e=t,i=this.skeleton.filter((e=>"internal"===e.type));e.radius=r,this.proportion.externalRadius=r,i.forEach((t=>{let i=t.offset>=0?1:-1;t.offset=i*(r-t.radius),t.staticCX=e.cx,t.staticCY=e.cy+i*(e.radius-t.radius),t.trace.clear()}))}if("internal"===t.type&&"internalRadius"===e){let e=this.skeleton.find((e=>"external"===e.type)),i=t;i.radius=r,this.proportion.internalRadius=r;let a=i.offset>=0?1:-1;i.offset=a*(e.radius-i.radius),i.staticCX=e.cx,i.staticCY=e.cy+a*(e.radius-i.radius),i.trace.clear()}}))}animate(e=1){e/=5;let r=this.skeleton.find((e=>"external"==e.type));this.skeleton.filter((e=>"internal"==e.type)).forEach((t=>{let i=(r.radius-t.radius)/t.radius,a=(!0===t.invertRotationDirection?-1:1)*e,n=t.parent.internalRotationGain;t.rotate(a*i*n),t.moveAroundOrigin(e)}))}render(){this.skeleton.forEach((e=>{e.trace&&e.trace.length>0&&e.trace.render(),e.render()}))}}function o(e,r,t,i){return[new n({label:"Custom curve",renderer:e,cx:r,cy:t,...i,traceColor:getColor("red")})]}function l(e,r,t,i){return[new n({label:"Deltoid",renderer:e,cx:r-.7*r,cy:t-.6*t,...i,externalRadius:50,internalRadius:16.66666666,radiusOfTracePoint:10,traceColor:getColor("brightRed"),traceThickness:.1}),new n({label:"Deltoid",renderer:e,cx:r-.7*r,cy:t,...i,externalRadius:50,internalRadius:16.66666666,radiusOfTracePoint:16.66666666,traceColor:getColor("deepOrange"),traceThickness:.1}),new n({label:"Deltoid",renderer:e,cx:r-.7*r,cy:t+.6*t,...i,externalRadius:50,internalRadius:16.66666666,radiusOfTracePoint:31,traceColor:getColor("amber"),traceThickness:.1}),new n({label:"Astroid",renderer:e,cx:r-.2*r-10,cy:t-.6*t,...i,externalRadius:50,internalRadius:12.5,radiusOfTracePoint:5,traceColor:getColor("green"),traceThickness:.1}),new n({label:"Astroid",renderer:e,cx:r-.2*r-10,cy:t,...i,externalRadius:50,internalRadius:12.5,radiusOfTracePoint:12.5,traceColor:getColor("teal"),traceThickness:.1}),new n({label:"Astroid",renderer:e,cx:r-.2*r-10,cy:t+.6*t,...i,externalRadius:50,internalRadius:12.5,radiusOfTracePoint:25,traceColor:getColor("blue"),traceThickness:.1}),new n({label:"Pentoid",renderer:e,cx:r+.3*r-20,cy:t-.6*t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:3,traceColor:getColor("indigo"),traceThickness:.1}),new n({label:"Pentoid",renderer:e,cx:r+.3*r-20,cy:t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:10,traceColor:getColor("deepPurple"),traceThickness:.1}),new n({label:"Pentoid",renderer:e,cx:r+.3*r-20,cy:t+.6*t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:20,traceColor:getColor("fuchsia"),traceThickness:.1}),new n({label:"Exoid",renderer:e,cx:r+.7*r,cy:t-.6*t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:3,traceColor:getColor("mediumVioletRed"),traceThickness:.1}),new n({label:"Exoid",renderer:e,cx:r+.7*r,cy:t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:8.33333,traceColor:getColor("crimson"),traceThickness:.1}),new n({label:"Exoid",renderer:e,cx:r+.7*r,cy:t+.6*t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:18,traceColor:getColor("brightRed"),traceThickness:.1})]}function s(e,r,t,i){return[new n({label:"Circle",renderer:e,cx:r-.7*r,cy:t-.6*t,...i,externalRadius:50,internalRadius:25,radiusOfTracePoint:25,traceColor:getColor("brightRed"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Cardioid",renderer:e,cx:r-.7*r,cy:t,...i,externalRadius:50,internalRadius:16.6666666666,radiusOfTracePoint:16.6666666666,traceColor:getColor("deepOrange"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Two leaf rose",renderer:e,cx:r-.7*r,cy:t+.6*t,...i,externalRadius:50,internalRadius:12.5,radiusOfTracePoint:12.5,traceColor:getColor("amber"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Three leaf rose",renderer:e,cx:r-.2*r-10,cy:t-.6*t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:6,traceColor:getColor("green"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Three leaf rose",renderer:e,cx:r-.2*r-10,cy:t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:9.99,traceColor:getColor("teal"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Three leaf rose",renderer:e,cx:r-.2*r-10,cy:t+.6*t,...i,externalRadius:50,internalRadius:10,radiusOfTracePoint:20,traceColor:getColor("blue"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Four leaf rose",renderer:e,cx:r+.3*r-20,cy:t-.6*t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:3,traceColor:getColor("indigo"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Four leaf rose",renderer:e,cx:r+.3*r-20,cy:t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:8.33333,traceColor:getColor("deepPurple"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Four leaf rose",renderer:e,cx:r+.3*r-20,cy:t+.6*t,...i,externalRadius:50,internalRadius:8.33333,radiusOfTracePoint:18,traceColor:getColor("fuchsia"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Five leaf rose",renderer:e,cx:r+.7*r,cy:t-.6*t,...i,externalRadius:50,internalRadius:7.142857142857143,radiusOfTracePoint:3,traceColor:getColor("mediumVioletRed"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Five leaf rose",renderer:e,cx:r+.7*r,cy:t,...i,externalRadius:50,internalRadius:7.142857142857143,radiusOfTracePoint:7.142857142857143,traceColor:getColor("crimson"),traceThickness:.1,invertRotationDirection:!1}),new n({label:"Five leaf rose",renderer:e,cx:r+.7*r,cy:t+.6*t,...i,externalRadius:50,internalRadius:7.142857142857143,radiusOfTracePoint:18,traceColor:getColor("brightRed"),traceThickness:.1,invertRotationDirection:!1})]}function c(e,r,t,i){return[new n({label:"Spiral curve",renderer:e,cx:r,cy:t,...i,traceColor:getColor("indigo"),externalRadius:190,internalRadius:95,internalInitialAngle:-180,internalRotationGain:1.015,radiusOfTracePoint:95,traceLength:1e4,traceThickness:.1,invertRotationDirection:!1})]}function d(e,r,t,i){return[new n({label:"Circle",renderer:e,cx:r-r/2,cy:t-t/3-10,...i,externalRadius:65,internalRadius:16.25,radiusOfTracePoint:16.25,traceColor:getColor("yellow"),traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t-t/3-10,...i,externalRadius:65,internalRadius:26,radiusOfTracePoint:26,traceColor:getColor("amber"),traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r+r/2,cy:t-t/3-10,...i,externalRadius:65,internalRadius:27.8571,radiusOfTracePoint:27.8571,traceColor:getColor("deepOrange"),traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r-r/2,cy:t+t/3+10,...i,externalRadius:65,internalRadius:14.44444444,radiusOfTracePoint:14.44444444,traceColor:getColor("indigo"),traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t+t/3+10,...i,externalRadius:65,internalRadius:20.3125,radiusOfTracePoint:20.3125,traceColor:getColor("purple"),traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r+r/2,cy:t+t/3+10,...i,externalRadius:65,internalRadius:28.88888888,radiusOfTracePoint:28.88888888,traceColor:getColor("brightRed"),traceThickness:.1})]}function u(e,r,t,i){let a=["rgba(220, 20, 60, 1.0)","rgba(202, 18, 79, 1.0)","rgba(185, 16, 99, 1.0)","rgba(168, 14, 118, 1.0)","rgba(150, 12, 138, 1.0)","rgba(133, 10, 157, 1.0)","rgba(116, 8, 177, 1.0)","rgba(98, 6, 196, 1.0)","rgba(81, 4, 216, 1.0)","rgba(64, 2, 235, 1.0)","rgba(47, 0, 255, 1.0)"];return[new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:190,internalRadius:47.5,radiusOfTracePoint:47.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[0],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:170,internalRadius:42.5,radiusOfTracePoint:42.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[1],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:150,internalRadius:37.5,radiusOfTracePoint:37.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[2],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:130,internalRadius:32.5,radiusOfTracePoint:32.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[3],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:110,internalRadius:27.5,radiusOfTracePoint:27.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[4],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:90,internalRadius:22.5,radiusOfTracePoint:22.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[5],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:70,internalRadius:17.5,radiusOfTracePoint:17.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[6],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:50,internalRadius:12.5,radiusOfTracePoint:12.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[7],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:30,internalRadius:7.5,radiusOfTracePoint:7.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[8],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:20,internalRadius:5,radiusOfTracePoint:5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[9],traceThickness:.1}),new n({label:"Circle",renderer:e,cx:r,cy:t,...i,externalRadius:10,internalRadius:2.5,radiusOfTracePoint:2.5,externalBorderColor:getColor("white",.1),internalBorderColor:getColor("white",.1),traceColor:a[10],traceThickness:.1})]}})();