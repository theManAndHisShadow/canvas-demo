(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function r(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var n=function(){return e=function e(t){var r=t.title,n=t.ui,i=t.code;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.displayName="Scene",this.title=r,this.uiTree=n,this.ui=null,this.code=i,this.timestamp=null},(r=[{key:"execute",value:function(e){var t=e.root,r=this.code;t.children[0].textContent=this.title,r(t,this.ui.display,this.ui.states)}}])&&t(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var l=a((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t||null,this.parent=null}));function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}var y=function(e){function t(e,r,n,i){var o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"white";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=function(e,t,r){return t=p(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,r||[],p(e).constructor):t.apply(e,r))}(this,t)).x=r,o.y=n,o.planeX=null,o.planeY=null,o.color=i,o.label=e,o.labelColor=a,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),r=t,(n=[{key:"draw",value:function(){this.label&&this.label.length>0&&drawText(this.renderer,{x:this.x+7,y:this.y-7,text:this.label,color:this.labelColor}),drawCircle(this.renderer,{cx:this.x,cy:this.y,fillColor:this.color,borderColor:this.color,r:2})}}])&&u(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(l);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function x(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}var P=function(e){function t(e,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t,r){return t=w(t),function(e,t){if(t&&("object"==b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,r||[],w(e).constructor):t.apply(e,r))}(this,t)).startPoint=new y(e[0],e[1],e[2],n),i.endPoint=new y(r[0],r[1],r[2],n),i.color=n,i.thickness=o,i.length=getDistanseBetweenTwoPoint(e[1],e[2],r[1],r[2]),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(t,e),r=t,(n=[{key:"draw",value:function(){drawLine(this.renderer,{x1:this.startPoint.x,y1:this.startPoint.y,x2:this.endPoint.x,y2:this.endPoint.y,thickness:this.thickness,color:this.startPoint.color}),this.startPoint.draw(),this.endPoint.draw()}}])&&v(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(l);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function O(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var j=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"detect",value:function(e){return/x\^3/g.test(e)?"cubic":/x\^2/g.test(e)?"quadratic":/e\^\{?\-?(\d+\/?\d+|0\.\d{1,})?x\}?/g.test(e)?"exponential":/\/\d?x/g.test(e)?"hyperbolic":"linear"}},{key:"parse",value:function(e,t){var r={},n=new RegExp("(?<!{)([+-])+","gm"),i=e.split(n),o=function(e){return e=/(\{|\})/gm.test(e)?e.replace(/(\{|\})/gm,""):e,/\//g.test(e)?Number(fractionToDecimal(e).toFixed(5)):e};if("linear"==t){var a=0,s=0;i.forEach((function(e,t){if(e.trim().length>0&&!n.test(e)){var r=t>0&&"-"===i[t-1]?-1:1;/x/.test(e)?(a=e.split("x")[0]||1,a=o(a)*r):s=o(e)*r}})),r={a,b:s}}else if("hyperbolic"==t){var l=0,c=0,u=0;i.forEach((function(e,t){if(e.trim().length>0&&!/[+-]/.test(e)){var r=t>0&&"-"===i[t-1]?-1:1;/\/\d{0,}x/.test(e)?(l=Number(e.split("/")[0]||1),c=(""==(c=(e.split("/")[1]||1).replace("x",""))?1:Number(c))*r):u=o(e)*r}})),r={a:l,b:c,c:u}}else if("quadratic"==t){var h=0,f=0,p=0;i.forEach((function(e,t){if(e.trim().length>0&&!/[+-]/.test(e)){var r=t>0&&"-"===i[t-1]?-1:1;/x\^2/.test(e)?(h=e.split("x")[0]||1,h=o(h)*r):/x/.test(e)?(f=e.split("x")[0]||1,f=o(f)*r):p=o(e)*r}})),r={a:h,b:f,c:p}}else if("cubic"==t){var d=0,y=0,b=0,v=0;i.forEach((function(e,t){if(e.trim().length>0&&!/[+-]/.test(e)){var r=t>0&&"-"===i[t-1]?-1:1;/x\^3/.test(e)?(d=e.split("x")[0]||1,d=o(d)*r):/x\^2/.test(e)?(y=e.split("x")[0]||1,y=o(y)*r):/x/.test(e)?(b=e.split("x")[0]||1,b=o(b)*r):v=o(e)*r}})),r={a:d,b:y,c:b,d:v}}else if("exponential"==t){var x=0,g=0,w=0;i.forEach((function(e,t){if(e.trim().length>0&&!n.test(e))if(/e\^\{?/g.test(e)){var r=t>0&&"-"===i[t-1]?-1:1;x=e.split("e")[0]||1,x=o(x)*r;var a=e.split("e^")[1].split("x")[0].replace(/\{?/g,"")||1,s=!0===/\-/g.test(a)?-1:1;g="string"==typeof a?a.replace(/\-?/,""):a,g=(o(g)||1)*s}else{var l=t>0&&"-"===i[t-1]?-1:1;w=o(e)*l}})),r={a:x,b:g,c:w}}return r}},{key:"findRoots",value:function(e,t){var r=[];if("linear"==e){var n=-1*t.b/t.a;r.push({x:n,y:0})}else if("quadratic"==e){var i=t.a,o=t.b,a=t.c,s=Math.pow(o,2)-4*i*a;if(s>0){var l=(-o+Math.sqrt(s))/(2*i),c=(-o-Math.sqrt(s))/(2*i);r.push({x:l,y:0}),r.push({x:c,y:0})}else if(0===s){var u=-o/(2*i);r.push({x:u,y:0})}else{var h=-o/(2*i),f=Math.sqrt(-s)/(2*i);r.push({x:h,y:f}),r.push({x:h,y:-f})}}else if("cubic"==e){var p=t.a,d=t.b,y=t.c,b=t.d,v=(3*p*y-Math.pow(d,2))/(3*Math.pow(p,2)),x=(2*Math.pow(d,3)-9*p*d*y+27*Math.pow(p,2)*b)/(27*Math.pow(p,3)),g=Math.pow(x,2)/4+Math.pow(v,3)/27;if(g>0){var w=Math.cbrt(-x/2+Math.sqrt(g))+Math.cbrt(-x/2-Math.sqrt(g))-d/(3*p);r.push({x:w,y:0})}else if(0===g){var m=Math.cbrt(-x/2),P=2*m-d/(3*p),C=-m-d/(3*p);r.push({x:P,y:0}),r.push({x:C,y:0})}else{var S=Math.sqrt(Math.pow(-1*v,3)/27),O=Math.acos(-x/(2*S)),j=2*Math.cbrt(S)*Math.cos(O/3)-d/(3*p),T=2*Math.cbrt(S)*Math.cos((O+2*Math.PI)/3)-d/(3*p),k=2*Math.cbrt(S)*Math.cos((O+4*Math.PI)/3)-d/(3*p);r.push({x:j,y:0}),r.push({x:T,y:0}),r.push({x:k,y:0})}}else if("hyperbolic"==e);else if("exponential"==e){var E=t.a,M=t.b,_=t.c;if(0!==E&&-_/E>0){var A=Math.log(-_/E)/M;r.push({x:A,y:0})}}return r}}])&&S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function z(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var R=new WeakSet,W=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(e=function(e,t,r){return t=_(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,M()?Reflect.construct(t,r||[],_(e).constructor):t.apply(e,r))}(this,t),R),e.processor=new j,e.parent=null,e.formula=r,e.type=e.processor.detect(e.formula),e.parsed=e.processor.parse(e.formula,e.type),e.roots=e.processor.findRoots(e.type,e.parsed),e.color=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(t,e),r=t,(n=[{key:"draw",value:function(){"linear"==this.type&&z(R,this,L).call(this,.1),"quadratic"==this.type&&z(R,this,B).call(this,.1),"cubic"==this.type&&z(R,this,D).call(this,.1),"hyperbolic"==this.type&&z(R,this,q).call(this,.001),"exponential"==this.type&&z(R,this,H).call(this,.075)}}])&&k(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(l);function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.beginPath(),this.renderer.strokeStyle=this.color,this.renderer.lineWidth=1;for(var t=!0,r=this.parent.visibleArea.x[0]-3;r<this.parent.visibleArea.x[1]+3;r+=e){var n=r,i=this.parsed.a*n+this.parsed.b,o=n*(2*this.parent.gridCellSize)+this.parent.subpixel,a=i*(2*this.parent.gridCellSize)+this.parent.subpixel,s={x:this.parent.cx+o,y:this.parent.cy-a};t?(this.renderer.moveTo(s.x,s.y),t=!1):this.renderer.lineTo(s.x,s.y)}this.renderer.closePath(),this.renderer.stroke()}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.beginPath(),this.renderer.strokeStyle=this.color,this.renderer.lineWidth=1;for(var t=!1,r=this.parent.visibleArea.x[0]-3;r<this.parent.visibleArea.x[1]+3;r+=e){var n=r,i=this.parsed.a*Math.pow(n,2)+this.parsed.b*n+this.parsed.c,o=n*(2*this.parent.gridCellSize)+this.parent.subpixel,a=i*(2*this.parent.gridCellSize)+this.parent.subpixel,s={x:this.parent.cx+o,y:this.parent.cy-a};s.x<0||s.x>this.parent.viewWidth?t&&(this.renderer.stroke(),this.renderer.closePath(),t=!1):t?this.renderer.lineTo(s.x,s.y):(this.renderer.beginPath(),this.renderer.moveTo(s.x,s.y),t=!0)}t&&(this.renderer.stroke(),this.renderer.closePath())}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.beginPath(),this.renderer.strokeStyle=this.color,this.renderer.lineWidth=1;for(var t=!1,r=this.parent.visibleArea.x[0]-3;r<this.parent.visibleArea.x[1]+3;r+=e){var n=r,i=this.parsed.a*Math.pow(n,3)+this.parsed.b*Math.pow(n,2)+this.parsed.c*n+this.parsed.d,o=n*(2*this.parent.gridCellSize)+this.parent.subpixel,a=i*(2*this.parent.gridCellSize)+this.parent.subpixel,s={x:this.parent.cx+o,y:this.parent.cy-a};s.x<0||s.x>this.parent.viewWidth?t&&(this.renderer.stroke(),this.renderer.closePath(),t=!1):t?this.renderer.lineTo(s.x,s.y):(this.renderer.beginPath(),this.renderer.moveTo(s.x,s.y),t=!0)}t&&(this.renderer.stroke(),this.renderer.closePath())}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.beginPath(),this.renderer.strokeStyle=this.color,this.renderer.lineWidth=1;for(var t=!1,r=this.parent.visibleArea.x[0]-3;r<this.parent.visibleArea.x[1]+3;r+=e){var n=r;if(!(Math.abs(n)<.001)){var i=this.parsed.a/(this.parsed.b*n)+this.parsed.c,o=n*(2*this.parent.gridCellSize)+this.parent.subpixel,a=i*(2*this.parent.gridCellSize)+this.parent.subpixel,s={x:this.parent.cx+o,y:this.parent.cy-a};s.x<0||s.x>this.parent.viewWidth?t&&(this.renderer.stroke(),this.renderer.closePath(),t=!1):t?this.renderer.lineTo(s.x,s.y):(this.renderer.beginPath(),this.renderer.moveTo(s.x,s.y),t=!0)}}t&&(this.renderer.stroke(),this.renderer.closePath()),t=!1;for(var l=e;l<this.parent.visibleArea.x[1]+3;l+=e){var c=l,u=this.parsed.a/(this.parsed.b*c)+this.parsed.c,h=c*(2*this.parent.gridCellSize)+this.parent.subpixel,f=u*(2*this.parent.gridCellSize)+this.parent.subpixel,p={x:this.parent.cx+h,y:this.parent.cy-f};p.x<0||p.x>this.parent.viewWidth?t&&(this.renderer.stroke(),this.renderer.closePath(),t=!1):t?this.renderer.lineTo(p.x,p.y):(this.renderer.beginPath(),this.renderer.moveTo(p.x,p.y),t=!0)}t&&(this.renderer.stroke(),this.renderer.closePath())}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.renderer.beginPath(),this.renderer.strokeStyle=this.color,this.renderer.lineWidth=1;for(var t=!1,r=this.parent.visibleArea.x[0]-4;r<this.parent.visibleArea.x[1]+4;r+=e){var n=r,i=(this.parsed.a*Math.exp(this.parsed.b*n)+this.parsed.c)*(2*this.parent.gridCellSize)+this.parent.subpixel,o=n*(2*this.parent.gridCellSize)+this.parent.subpixel,a={x:this.parent.cx+o,y:this.parent.cy-i},s=5*this.parent.gridCellSize;a.x<0||a.x>this.parent.viewWidth||a.y<0-s||a.y>this.parent.viewHeight+s?t&&(this.renderer.stroke(),this.renderer.closePath(),t=!1):t?this.renderer.lineTo(a.x,a.y):(this.renderer.beginPath(),this.renderer.moveTo(a.x,a.y),t=!0)}t&&(this.renderer.stroke(),this.renderer.closePath())}function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(X=function(){return!!e})()}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function N(e,t){return e.get(G(e,t))}function G(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K(n.key),n)}}function Q(e,t,r){return t&&J(e.prototype,t),r&&J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K(e){var t=function(e){if("object"!=I(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==I(t)?t:t+""}var U=function(){return Q((function e(){V(this,e),this.events={}}),[{key:"addEventListener",value:function(e,t){this.events[e]||(this.events[e]=[]),this.target=this,this.events[e].push(t)}},{key:"dispatchEvent",value:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))}}])}(),Z=new WeakMap,$=function(e){function t(e){var r,n,i,o,a=e.cx,s=e.cy,l=e.renderer,c=e.gridCellSize,u=void 0===c?10:c,h=e.gridLineColor,f=void 0===h?"black":h,p=e.gridLineThickness,d=void 0===p?1:p,y=e.fillColor,b=void 0===y?"white":y,v=e.axisColor,x=void 0===v?"black":v;return V(this,t),function(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}((n=this,i=Y(i=t),r=function(e,t){if(t&&("object"==I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(n,X()?Reflect.construct(i,o||[],Y(n).constructor):i.apply(n,o))),Z,[]),r.cx=a,r.cy=s,r.globalOffset={x:0,y:0},r.visibleArea={x:[0,0],y:[0,0]},r.renderer=l,r.viewWidth=l.canvas.width,r.viewHeight=l.canvas.height,r.gridCellSize=u,r.gridLineColor=f,r.gridLineThickness=d,r.axisColor=x,r.fillColor=b,r.subpixel=.5,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(t,e),Q(t,[{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Math.round(e.x*t),n=Math.round(e.y*t);this.cx=this.cx+r,this.cy=this.cy+n,this.globalOffset.x=this.globalOffset.x+r,this.globalOffset.y=this.globalOffset.y+n,N(Z,this).forEach((function(e){e instanceof y?(e.x=e.x+r,e.y=e.y+n):e instanceof P&&(e.startPoint.x=e.startPoint.x+r,e.startPoint.y=e.startPoint.y+n,e.endPoint.x=e.endPoint.x+r,e.endPoint.y=e.endPoint.y+n)}))}},{key:"moveToOrigin",value:function(){var e=this;this.cx=this.viewWidth/2,this.cy=this.viewHeight/2,N(Z,this).forEach((function(t){t instanceof y?(t.x=t.x-e.globalOffset.x,t.y=t.y-e.globalOffset.y):t instanceof P&&(t.startPoint.x=t.startPoint.x-e.globalOffset.x,t.startPoint.y=t.startPoint.y-e.globalOffset.y,t.endPoint.x=t.endPoint.x-e.globalOffset.x,t.endPoint.y=t.endPoint.y-e.globalOffset.y)})),this.globalOffset={x:0,y:0}}},{key:"drawAxis",value:function(){this.renderer.strokeStyle=this.axisColor,this.renderer.lineWidth=1,this.renderer.beginPath(),this.renderer.moveTo(0,this.cy+this.subpixel),this.renderer.lineTo(this.viewWidth,this.cy+this.subpixel),this.renderer.stroke(),this.renderer.beginPath(),this.renderer.moveTo(this.cx+this.subpixel,0),this.renderer.lineTo(this.cx+this.subpixel,this.viewHeight),this.renderer.stroke(),this.renderer.closePath()}},{key:"drawGrid",value:function(){var e=this,t=this.viewWidth,r=this.viewHeight,n=this.gridLineColor,i=n.split(", ").map((function(e){return Number(e.replace(/(\(|\)|rgba|rgb)/gm,""))})),o=i.map((function(e,t){return 3==t&&e<=1?i[t]+.45:e})),a="rgba("+o+")";this.renderer.lineWidth=this.gridLineThickness;for(var s=function(i,o){if(e.renderer.beginPath(),e.renderer.strokeStyle=a,"column"===o){var s=i+2*e.gridCellSize+e.subpixel;e.renderer.moveTo(s,0),e.renderer.lineTo(s,r)}else if("row"===o){var l=i+e.subpixel;e.renderer.moveTo(0,l),e.renderer.lineTo(t,l)}e.renderer.stroke(),e.renderer.closePath(),e.renderer.beginPath(),e.renderer.strokeStyle=n;for(var c=3;c<=5;c++)if("column"===o){var u=i+e.gridCellSize*c+e.subpixel;e.renderer.moveTo(u,0),e.renderer.lineTo(u,r)}else if("row"===o){var h=i+e.gridCellSize*(c-2)+e.subpixel;e.renderer.moveTo(0,h),e.renderer.lineTo(t,h)}e.renderer.stroke(),e.renderer.closePath()},l=4*this.gridCellSize,c=this.cx-t/2,u=Math.trunc(this.globalOffset.x/l),h=t/l-u,f=-1-u;f<h;f++){var p=c+f*l,d=2*(f-7);s(p,"column"),drawText(this.renderer,{x:p+l/2,y:this.cy-10,text:0==d?"":d,fontSize:11}),f==-1-u&&(this.visibleArea.x[0]=d+2),f==h-1&&(this.visibleArea.x[1]=d)}for(var y=this.cy-r/2,b=Math.trunc(this.globalOffset.y/l),v=-1-b,x=r/l-b+1,g=v;g<x;g++){var w=y+g*l,m=2*(g-5)*-1;s(w,"row"),drawText(this.renderer,{x:this.cx-7,y:0==m?w+12:w+1,text:m,fontSize:11,align:"right"}),g==v&&(this.visibleArea.y[0]=m-2),g==x-1&&(this.visibleArea.y[1]=m)}}},{key:"add",value:function(e){var t=this;e.renderer=this.renderer;var r=function(e){e.planeX=e.x,e.planeY=e.y;var r=t.cx+e.x*(2*t.gridCellSize)+t.globalOffset.x+t.subpixel,n=t.cy-e.y*(2*t.gridCellSize)+t.globalOffset.y+t.subpixel;e.x=r,e.y=n};e instanceof y?r(e):e instanceof P?(e.startPoint.renderer=this.renderer,r(e.startPoint),e.endPoint.renderer=this.renderer,r(e.endPoint),e.parent=this):e instanceof W&&(e.parent=this),N(Z,this).push(e)}},{key:"clearContent",value:function(){var e,t;t=[],(e=Z).set(G(e,this),t),this.render()}},{key:"fill",value:function(){drawRect(this.renderer,{x:0,y:0,width:this.viewWidth,height:this.viewHeight,fillColor:this.fillColor})}},{key:"render",value:function(){this.fill(),this.drawGrid(),this.drawAxis(),N(Z,this).length>0&&N(Z,this).forEach((function(e){e.draw()})),this.dispatchEvent("redraw")}}])}(U),ee=new n({title:"Cartesian plane demo",ui:{description:{type:"display-infobox",label:"Description",text:"Cartesian coordinate system in a plane is a coordinate system that specifies each point uniquely by a pair of real numbers called coordinates, which are the signed distances to the point from two fixed perpendicular oriented lines, called coordinate lines or coordinate axes."},centerViewAction:{type:"button",text:"reset",label:"Center view"},selectedPreset:{type:"preset-dropdown-list",label:"Preset",selectedByDefault:0,options:[{name:"Single points",allowedElements:["*"]},{name:"Segments",allowedElements:["*"]},{name:"Line",allowedElements:["*"]},{name:"Quadratic parabola",allowedElements:["*"]},{name:"Cubic parabola",allowedElements:["*"]},{name:"Hyperbola",allowedElements:["*"]},{name:"Exponential curve",allowedElements:["*"]}]}},code:function(e,t,r){window.runningAnimations.clearQueue();var n=Date.now(),i=resetElement(e.querySelector("canvas"),"canvas-".concat(n));i.width=600,i.height=400;var o=i.getContext("2d"),a=new $({renderer:o,cx:300,cy:200,gridCellSize:10,gridLineColor:"rgba(35, 35, 35, 0.35)",gridLineThickness:1,axisColor:"white",fillColor:"black"});a.render();var s=!1,l={x:0,y:0},c={x:0,y:0};i.addEventListener("mousemove",(function(e){if(s){var t=getMousePos(i,e);c={x:t.x-l.x,y:t.y-l.y},l=t,a.move(c,1),a.render()}})),i.addEventListener("mousedown",(function(e){s=!0;var t=getMousePos(i,e);l={x:t.x,y:t.y},i.style.cursor="grab",setTimeout((function(){i.style.cursor="grabbing"}),120)})),i.addEventListener("mouseup",(function(){s=!1,i.style.cursor="inherit"}));var u="";a.addEventListener("redraw",(function(){u="\n                <br/> \n                - x-axis - [".concat(a.visibleArea.x,"], <br/> \n                - y-axis - [").concat(a.visibleArea.y[0]-2,", ").concat(a.visibleArea.y[1],"].\n            "),t.isExist("visibleArea")&&t.updateValue("visibleArea",u)})),r.subscribe((function(e,r,n){if("centerViewAction"==e&&(a.moveToOrigin(),a.render()),"selectedPreset"==e){if(a.moveToOrigin(),a.clearContent(),t.removeDynamicllyRendered(),0==r)[new y("O",0,0,"white"),new y("A",2,2,getColor("orange"),getColor("red")),new y("B",-2,2,getColor("lime"),getColor("green")),new y("C",-2,-2,getColor("purple"),getColor("deepPurple")),new y("D",2,-2,getColor("blue"),getColor("indigo"))].forEach((function(e){a.add(e),t.dynamicRender("point".concat(e.label),{type:"display-item",label:'- point <span style="font-weight: bold">'.concat(e.label,"</span>"),text:'<i style="font-size: 15px">('.concat(e.planeX,", ").concat(e.planeY,")</i>")})}));else if(1==r)[new y("O",0,0,"white"),new P(["A",-5.5,2],["B",-1.5,2],"#ff0000",1),new P(["B",-1.5,2],["C",0,6],"#ff7f00",1),new P(["C",0,6],["D",1.5,2],"#ffff00",1),new P(["D",1.5,2],["E",5.5,2],"#7fff00",1),new P(["E",5.5,2],["F",2,0],"cyan",1),new P(["F",2,0],["G",3.5,-4],"#007fff",1),new P(["G",3.5,-4],["H",0,-2],"blue",1),new P(["H",0,-2],["I",-3.5,-4],"indigo",1),new P(["I",-3.5,-4],["J",-2,0],"magenta",1),new P(["J",-2,0],["A",-5.5,2],"crimson",1)].forEach((function(e){a.add(e),e instanceof y?t.dynamicRender("point".concat(e.label),{type:"display-item",label:'- point <span style="font-weight: bold">'.concat(e.label,"</span>"),text:'<i style="font-size: 15px">('.concat(e.planeX,", ").concat(e.planeY,")</i>")}):e instanceof P&&t.dynamicRender("segment".concat(e.startPoint.label+e.endPoint.label),{type:"display-item",label:'- segment <span style="font-weight: bold; color: black; text-shadow: 0px 0px 3px  '.concat(e.color,'; border-radius: 3px;"> ').concat(e.startPoint.label).concat(e.endPoint.label,"</span>"),text:'[ <i style="font-size: 15px">('.concat(e.startPoint.planeX,", ").concat(e.startPoint.planeY,"), (").concat(e.endPoint.planeX,", ").concat(e.endPoint.planeY,")</i> ]")})}));else if(r>=2&&r<=6){var i=r-2,o=[[new W("x",getColor("red")),new W("-x",getColor("orange")),new W("{1/3}x",getColor("green")),new W("{-1/3}x",getColor("blue")),new W("3x",getColor("indigo")),new W("-3x",getColor("purple"))],[new W("x^2",getColor("red")),new W("-x^2",getColor("purple")),new W("1/10x^2",getColor("green")),new W("-1/10x^2",getColor("cyan")),new W("0.25x^2-5",getColor("orange")),new W("-0.25x^2+5",getColor("indigo"))],[new W("1/100x^3",getColor("red")),new W("-1/100x^3",getColor("blue")),new W("x^3+3x^2-6",getColor("amber")),new W("-x^3-3x^2+6",getColor("purple"))],[new W("1/x",getColor("red")),new W("-1/x",getColor("purple")),new W("2/x",getColor("amber")),new W("-2/x",getColor("teal")),new W("3/x",getColor("green")),new W("-3/x",getColor("cyan"))],[new W("e^x",getColor("red")),new W("e^{5/10x}",getColor("amber")),new W("e^{3/10x}",getColor("yellow")),new W("e^{2/10x}",getColor("green")),new W("e^1/10x",getColor("blue")),new W("-e^1/10x",getColor("deepPurple"))]];console.log(o[i]),t.dynamicRender("visibleArea",{type:"display-item",label:"Current visible area",text:u}),t.dynamicRender("spacer",{type:"display-spacer"}),t.dynamicRender("function-list-title",{type:"display-item",label:"Function graphs drawn",text:o[i].length}),o[i].forEach((function(e,r){var n;a.add(e),t.dynamicRender("function-formula-"+r,{type:"display-float-tile",hideColon:!0,label:(n=e.color,'\n<span style="\n    background: '.concat(changeColorOpacity(n,.75),"; \n    border: 2px solid ").concat(n,'; \n    border-radius: 100%;\n    right: 2px;\n    width: 8px;\n    display: block;\n    position: relative;\n    height: 8px;\n"></span>')),text:"ƒ(x) = ".concat(t.renderFormula(e.formula),";")})}))}a.render()}})),r.setState("selectedPreset",0)}});window.exportedObjects.push(ee)})();