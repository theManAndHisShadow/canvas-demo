(()=>{"use strict";let e=new class{constructor({title:e,ui:t,code:n}){this.displayName="Scene",this.title=e,this.uiTree=t,this.ui=null,this.code=n,this.timestamp=null}execute({root:e}){let t=this.code;e.children[0].textContent=this.title,t(e,this.ui.display,this.ui.states)}}({title:"Color picker demo scene",ui:{description:{type:"display-infobox",label:"Description",text:"Color picker based on multicolor radial gradient and mouse events. Move range slider to adjust color. Click on the desired location on the circle to get color data."},currentColor:{type:"display-item",label:"Picker"},"use-hex":{type:"checkbox",label:"Use HEX colors"},"adjustment-slider":{type:"range-slider",startLabel:"Darker",endLabel:"Lighter",minValue:0,maxValue:100,defaultValue:50}},code:(e,n,a)=>{window.runningAnimations.clearQueue();const o=Date.now();let r=resetElement(e.querySelector("canvas"),`canvas-${o}`);r.width=600,r.height=400;const s=r.getContext("2d",{willReadFrequently:!0});let i=!1,l=!1,d=!1,c=!1;const u=e=>{e/=100,s.clearRect(0,0,600,400),function(e,{radius:t=120,brightness:n=1}={}){const a=e.canvas.width,o=e.canvas.height,r=a/2,s=o/2,i=e.createImageData(a,o);let l=[0,0,0];for(let e=0;e<o;e++)for(let o=0;o<a;o++){const d=4*(e*a+o);let c=getDistanseBetweenTwoPoint(r,s,o,e),u=rotatePoint(r,s,o,e,90),h=getNormalizedAngle(r,s,u.x,u.y);if(c<=t-2){h<1/6?(l[0]=255,l[1]=Math.round(6*h*255),l[2]=0):h<2/6?(l[0]=Math.round(255-6*(h-1/6)*255),l[1]=255,l[2]=0):h<.5?(l[0]=0,l[1]=255,l[2]=Math.round(6*(h-2/6)*255)):h<4/6?(l[0]=0,l[1]=Math.round(255-6*(h-.5)*255),l[2]=255):h<5/6?(l[0]=Math.round(6*(h-4/6)*255),l[1]=0,l[2]=255):(l[0]=255,l[1]=0,l[2]=Math.round(255-6*(h-5/6)*255));let e=getBezierCurveValue(n),t=e>=.5?255:0,a=e>=.5?2*(e-.5):1-2*e,o=(t-l[0])*a,r=(t-l[1])*a,s=(t-l[2])*a;l[0]+=o,l[1]+=r,l[2]+=s}else l[0]=255,l[1]=255,l[2]=255;i.data[d]=l[0],i.data[d+1]=l[1],i.data[d+2]=l[2],i.data[d+3]=255}e.putImageData(i,0,0)}(s,{radius:150,brightness:e}),function(e,{radius:t,colorOrder:n,brightness:a}){const o=e.canvas.width/2,r=e.canvas.height/2,s=Array.isArray(n)>0?n.length:6;e.font="bold 12px Arial",e.textAlign="center",e.textBaseline="middle";let i=0,l=0,d=360/s;for(let s=0,c=-1;s<180;s++){let s={x:o,y:r-t-10},u=rotatePoint(o,r,s.x,s.y,i),h=rotatePoint(o,r,s.x,s.y-10,i);if(drawLine(e,{x1:u.x,y1:u.y,x2:h.x,y2:h.y,thickness:i==l?1:.5,color:i==l?"black":"rgba(0, 0, 0, 0.3)"}),i==l){c++;let t=n.length>0?n[c].offset:10,u=rotatePoint(o,r,s.x,s.y-t,i),h=n[c].name;a<.05&&(h="BLACK"),a>.99&&(h="WHITE"),l+=d,e.fillText(h,u.x,u.y)}i+=2}}(s,{radius:150,colorOrder:[{name:"RED",offset:20},{name:"YELLOW",offset:30},{name:"GREEN",offset:35},{name:"CYAN",offset:25},{name:"BLUE",offset:30},{name:"MAGENTA",offset:30}],brightness:e})};a.setState("adjustment-slider",50),u(50),a.subscribe(((e,t,n)=>{"adjustment-slider"==e&&(u(t),h()),"use-hex"==e&&h()}));let h=()=>{if(d){let e=s.getImageData(d.x,d.y,1,1).data,t=e[0],o=e[1],r=e[2],i=`rgba(${t}, ${o}, ${r}, 1)`,l=!0===a.getState("use-hex")?rgba2hex(t,o,r,1):`rgba(${t}, ${o}, ${r}, 1)`,c=((e,t)=>t<49?e:t>=80?"rgba(0, 0, 0, 1)":getColorDominantComponent(e))(i,a.getState("adjustment-slider")),u=changeColorOpacity(i,.35);n.updateValue("currentColor",`<span style="\n                                background: ${i}; \n                                width: 9px;\n                                height: 9px;\n                                position: relative;\n                                display: inline-block;\n                                border-radius: 100%;\n                                border: 2px solid rgba(0, 0, 0, 0.25);\n                                padding: 1px;\n                                left: 3px;\n                                top: 3px;\n                            "></span>\n                            <span class="gray-word-bubble" style="\n                                font-size: 13px;\n                                background: ${u};\n                                color: ${c}\n                            ">\n                                ${l}\n                            </span>`)}};r.addEventListener("mousemove",(e=>{l=getMousePos(r,e);let n=getDistanseBetweenTwoPoint(l.x,l.y,r.width/2,r.height/2);i=n-150<0,r.style.cursor=i?"crosshair":"inherit",!0===i&&!0===c&&(d=l,t(s,{radius:7,x:d.x,y:d.y,forElement:r.id}),h())})),r.parentNode.addEventListener("mousedown",(e=>{c=!0,l=getMousePos(r,e),d=l})),r.parentNode.addEventListener("mouseup",(e=>{c=!1,l=getMousePos(r,e),d=l,!0===i&&t(s,{radius:7,x:d.x,y:d.y})}))}});function t(e,{radius:t=10,x:n,y:a,forElement:o}){let r=document.querySelector("#color-picker"),s=e.canvas.parentNode;r?(r.style.left=n+23+"px",r.style.top=a+51+"px"):(r=document.createElement("span"),r.id="color-picker",r.style=`\n                width: ${t}px;\n                height: ${t}px;\n                left: ${n}px;\n                top: ${a}px;\n                position: absolute;\n                background: #ffffff;\n                border-radius: 100%;\n                border: 1px solid black;\n                cursor: crosshair;\n            `,o&&o.length>0&&r.setAttribute("data-element-for",o),s.appendChild(r))}window.exportedObjects.push(e)})();